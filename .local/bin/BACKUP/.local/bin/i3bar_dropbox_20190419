#!/bin/bash

font='Font Awesome 5 Free Solid 11'
foreground=$(xrdb -query | grep ^'*foreground' | awk '{print $NF}')
background=$(xrdb -query | grep ^'*background' | awk '{print $NF}')
label=""
fg=$foreground
bg=$background
sp=""
#full_text=""
#short_text=""

status=$(dropbox-cli status)

if ! [[ $status = *"Up to date"* ]]
then
    fg=$background
    bg=$foreground
    sp=" "
    if [[ $status = *"Uploading"* ]]
    then
        label=
    elif [[ $status = *"Downloading"* ]]
    then
        label=
    fi
fi


echo "<span background=\""$bg"\" foreground=\""$fg"\">$sp<span font=\""$font"\">$label</span>$full_text$sp</span>"
echo "<span background=\""$bg"\" foreground=\""$fg"\">$sp<span font=\""$font"\">$label</span>$short_text$sp</span>"

case $BLOCK_BUTTON in
  1) notify-send "Dropbox" "$(dropbox-cli status)" ;;  # left click
  3) urxvt -e ranger ~/Dropbox ;;  # right click
  4) dropbox start ;;  # scroll up
  5) dropbox stop ;;  # scroll down
esac
